import{COMMENT as e,DECLARATION as a,RULESET as c}from"./Enum.js";import{strlen as s,append as r,replace as t,indexof as f,sizeof as i,substr as n,abs as u,trim as o,from as l}from"./Utility.js";import{dealloc as k,alloc as b,next as m,peek as h,delimit as d,identifier as w,commenter as p,escaping as j,whitespace as v,node as g,char as x,prev as y,caret as z}from"./Tokenizer.js";function A(e){return k(C("",null,null,null,[""],e=b(e),0,[0],e))}function C(e,a,c,i,n,u,o,k,b){for(var g=0,x=0,A=o,q=0,B=0,D=0,F=1,G=1,H=1,I=0,J="",K=n,L=u,M=i,N=J;G;)switch(D=I,I=m()){case 40:if(108!=D&&58==N.charCodeAt(A-1)){-1!=f(N+=t(d(I),"&","&\f"),"&\f")&&(H=-1);break}case 34:case 39:case 91:N+=d(I);break;case 9:case 10:case 13:case 32:N+=v(D);break;case 92:N+=j(z()-1,7);continue;case 47:switch(h()){case 42:case 47:r(T(p(m(),z()),a,c),b);break;default:N+="/"}break;case 123*F:k[g++]=s(N)*H;case 125*F:case 59:case 0:switch(I){case 0:case 125:G=0;case 59+x:B>0&&s(N)-A&&r(B>32?U(N+";",i,c,A-1):U(t(N," ","")+";",i,c,A-2),b);break;case 59:N+=";";default:if(r(M=E(N,a,c,g,x,n,k,J,K=[],L=[],A),u),123===I)if(0===x)C(N,a,M,M,K,u,A,k,L);else switch(q){case 100:case 109:case 115:C(e,M,M,i&&r(E(e,M,M,0,0,n,k,J,n,K=[],A),L),n,L,A,k,i?K:L);break;default:C(N,M,M,M,[""],L,0,k,L)}}g=x=B=0,F=H=1,J=N="",A=o;break;case 58:A=1+s(N),B=D;default:if(F<1)if(123==I)--F;else if(125==I&&0==F++&&125==y())continue;switch(N+=l(I),I*F){case 38:H=x>0?1:(N+="\f",-1);break;case 44:k[g++]=(s(N)-1)*H,H=1;break;case 64:45===h()&&(N+=d(m())),q=h(),x=A=s(J=N+=w(z())),I++;break;case 45:45===D&&2==s(N)&&(F=0)}}return u}function E(e,a,s,r,f,l,k,b,m,h,d){for(var w=f-1,p=0===f?l:[""],j=i(p),v=0,x=0,y=0;v<r;++v)for(var z=0,A=n(e,w+1,w=u(x=k[v])),C=e;z<j;++z)(C=o(x>0?p[z]+" "+A:t(A,/&\f/g,p[z])))&&(m[y++]=C);return g(e,a,s,0===f?c:b,m,h,d)}function T(a,c,s){return g(a,c,s,e,l(x()),n(a,2,-2),0)}function U(e,c,s,r){return g(e,c,s,a,n(e,0,r),n(e,r+1,-1),r)}export{T as comment,A as compile,U as declaration,C as parse,E as ruleset};
//# sourceMappingURL=Parser.js.map
