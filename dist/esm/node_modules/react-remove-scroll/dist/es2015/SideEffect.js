import{__spreadArray as e}from"../../../tslib/tslib.es6.js";import"../../../react/index.js";import{RemoveScrollBar as t}from"../../../react-remove-scroll-bar/dist/es2015/component.js";import{styleSingleton as r}from"../../../react-style-singleton/dist/es2015/component.js";import{nonPassive as n}from"./aggresiveCapture.js";import{locationCouldBeScrolled as o,handleScroll as c}from"./handleScroll.js";import{r as a}from"../../../../_virtual/index.js";var u=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},i=function(e){return[e.deltaX,e.deltaY]},s=function(e){return e&&"current"in e?e.current:e},l=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},f=0,p=[];function d(d){var v=a.exports.useRef([]),m=a.exports.useRef([0,0]),h=a.exports.useRef(),g=a.exports.useState(f++)[0],x=a.exports.useState((function(){return r()}))[0],b=a.exports.useRef(d);a.exports.useEffect((function(){b.current=d}),[d]),a.exports.useEffect((function(){if(d.inert){document.body.classList.add("block-interactivity-".concat(g));var t=e([d.lockRef.current],(d.shards||[]).map(s),!0).filter(Boolean);return t.forEach((function(e){return e.classList.add("allow-interactivity-".concat(g))})),function(){document.body.classList.remove("block-interactivity-".concat(g)),t.forEach((function(e){return e.classList.remove("allow-interactivity-".concat(g))}))}}}),[d.inert,d.lockRef.current,d.shards]);var k=a.exports.useCallback((function(e,t){if("touches"in e&&2===e.touches.length)return!b.current.allowPinchZoom;var r,n=u(e),a=m.current,i="deltaX"in e?e.deltaX:a[0]-n[0],s="deltaY"in e?e.deltaY:a[1]-n[1],l=e.target,f=Math.abs(i)>Math.abs(s)?"h":"v";if("touches"in e&&"h"===f&&"range"===l.type)return!1;var p=o(f,l);if(!p)return!0;if(p?r=f:(r="v"===f?"h":"v",p=o(f,l)),!p)return!1;if(!h.current&&"changedTouches"in e&&(i||s)&&(h.current=r),!r)return!0;var d=h.current||r;return c(d,t,e,"h"===d?i:s,!0)}),[]),y=a.exports.useCallback((function(e){var t=e;if(p.length&&p[p.length-1]===x){var r="deltaY"in t?i(t):u(t),n=v.current.filter((function(e){return e.name===t.type&&e.target===t.target&&(n=e.delta,o=r,n[0]===o[0]&&n[1]===o[1]);var n,o}))[0];if(n&&n.should)t.cancelable&&t.preventDefault();else if(!n){var o=(b.current.shards||[]).map(s).filter(Boolean).filter((function(e){return e.contains(t.target)}));(o.length>0?k(t,o[0]):!b.current.noIsolation)&&t.cancelable&&t.preventDefault()}}}),[]),E=a.exports.useCallback((function(e,t,r,n){var o={name:e,delta:t,target:r,should:n};v.current.push(o),setTimeout((function(){v.current=v.current.filter((function(e){return e!==o}))}),1)}),[]),C=a.exports.useCallback((function(e){m.current=u(e),h.current=void 0}),[]),L=a.exports.useCallback((function(e){E(e.type,i(e),e.target,k(e,d.lockRef.current))}),[]),R=a.exports.useCallback((function(e){E(e.type,u(e),e.target,k(e,d.lockRef.current))}),[]);a.exports.useEffect((function(){return p.push(x),d.setCallbacks({onScrollCapture:L,onWheelCapture:L,onTouchMoveCapture:R}),document.addEventListener("wheel",y,n),document.addEventListener("touchmove",y,n),document.addEventListener("touchstart",C,n),function(){p=p.filter((function(e){return e!==x})),document.removeEventListener("wheel",y,n),document.removeEventListener("touchmove",y,n),document.removeEventListener("touchstart",C,n)}}),[]);var j=d.removeScrollBar,w=d.inert;return a.exports.createElement(a.exports.Fragment,null,w?a.exports.createElement(x,{styles:l(g)}):null,j?a.exports.createElement(t,{gapMode:"margin"}):null)}export{d as RemoveScrollSideCar,i as getDeltaXY,u as getTouchXY};
//# sourceMappingURL=SideEffect.js.map
