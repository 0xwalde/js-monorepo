import{createContext as e,mergeRefs as n}from"../../react-utils/dist/chakra-ui-react-utils.esm.js";import"../../../react/index.js";import{r as t}from"../../../../_virtual/index.js";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},r.apply(this,arguments)}function i(e){return e.sort((function(e,n){var t=e.compareDocumentPosition(n);if(t&Node.DOCUMENT_POSITION_FOLLOWING||t&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(t&Node.DOCUMENT_POSITION_PRECEDING||t&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(t&Node.DOCUMENT_POSITION_DISCONNECTED||t&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0}))}function s(e,n,t){var r=e+1;return t&&r>=n&&(r=0),r}function u(e,n,t){var r=e-1;return t&&r<0&&(r=n),r}var d="undefined"!=typeof window?t.exports.useLayoutEffect:t.exports.useEffect,o=function(){var e=this;this.descendants=new Map,this.register=function(n){var t;if(null!=n)return"object"==typeof(t=n)&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE?e.registerNode(n):function(t){e.registerNode(t,n)}},this.unregister=function(n){e.descendants.delete(n);var t=i(Array.from(e.descendants.keys()));e.assignIndex(t)},this.destroy=function(){e.descendants.clear()},this.assignIndex=function(n){e.descendants.forEach((function(e){var t=n.indexOf(e.node);e.index=t,e.node.dataset.index=e.index.toString()}))},this.count=function(){return e.descendants.size},this.enabledCount=function(){return e.enabledValues().length},this.values=function(){return Array.from(e.descendants.values()).sort((function(e,n){return e.index-n.index}))},this.enabledValues=function(){return e.values().filter((function(e){return!e.disabled}))},this.item=function(n){if(0!==e.count())return e.values()[n]},this.enabledItem=function(n){if(0!==e.enabledCount())return e.enabledValues()[n]},this.first=function(){return e.item(0)},this.firstEnabled=function(){return e.enabledItem(0)},this.last=function(){return e.item(e.descendants.size-1)},this.lastEnabled=function(){var n=e.enabledValues().length-1;return e.enabledItem(n)},this.indexOf=function(n){var t,r;return n&&null!=(t=null==(r=e.descendants.get(n))?void 0:r.index)?t:-1},this.enabledIndexOf=function(n){return null==n?-1:e.enabledValues().findIndex((function(e){return e.node.isSameNode(n)}))},this.next=function(n,t){void 0===t&&(t=!0);var r=s(n,e.count(),t);return e.item(r)},this.nextEnabled=function(n,t){void 0===t&&(t=!0);var r=e.item(n);if(r){var i=s(e.enabledIndexOf(r.node),e.enabledCount(),t);return e.enabledItem(i)}},this.prev=function(n,t){void 0===t&&(t=!0);var r=u(n,e.count()-1,t);return e.item(r)},this.prevEnabled=function(n,t){void 0===t&&(t=!0);var r=e.item(n);if(r){var i=u(e.enabledIndexOf(r.node),e.enabledCount()-1,t);return e.enabledItem(i)}},this.registerNode=function(n,t){if(n&&!e.descendants.has(n)){var s=i(Array.from(e.descendants.keys()).concat(n));null!=t&&t.disabled&&(t.disabled=!!t.disabled);var u=r({node:n,index:-1},t);e.descendants.set(n,u),e.assignIndex(s)}}};var a=e({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"}),c=a[0],f=a[1];function l(){return[c,function(){return f()},function(){return e=t.exports.useRef(new o),d((function(){return function(){return e.current.destroy()}})),e.current;var e},function(e){return function(e){var r=f(),i=t.exports.useState(-1),s=i[0],u=i[1],o=t.exports.useRef(null);d((function(){return function(){o.current&&r.unregister(o.current)}}),[]),d((function(){if(o.current){var e=Number(o.current.dataset.index);s==e||Number.isNaN(e)||u(e)}}));var a=e?r.register(e):r.register;return{descendants:r,index:s,enabledIndex:r.enabledIndexOf(o.current),register:n(a,o)}}(e)}]}export{l as createDescendantContext,l as default};
//# sourceMappingURL=chakra-ui-descendant.esm.js.map
