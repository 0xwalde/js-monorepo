{"version":3,"file":"chakra-ui-descendant.esm.js","sources":["../../../../../../node_modules/@chakra-ui/descendant/dist/chakra-ui-descendant.esm.js"],"sourcesContent":["import { createContext, mergeRefs } from '@chakra-ui/react-utils';\nimport { useLayoutEffect, useEffect, useRef, useState } from 'react';\n\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\n\n/**\n * Sort an array of DOM nodes according to the HTML tree order\n * @see http://www.w3.org/TR/html5/infrastructure.html#tree-order\n */\n\nfunction sortNodes(nodes) {\n  return nodes.sort(function (a, b) {\n    var compare = a.compareDocumentPosition(b);\n\n    if (compare & Node.DOCUMENT_POSITION_FOLLOWING || compare & Node.DOCUMENT_POSITION_CONTAINED_BY) {\n      // a < b\n      return -1;\n    }\n\n    if (compare & Node.DOCUMENT_POSITION_PRECEDING || compare & Node.DOCUMENT_POSITION_CONTAINS) {\n      // a > b\n      return 1;\n    }\n\n    if (compare & Node.DOCUMENT_POSITION_DISCONNECTED || compare & Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC) {\n      throw Error(\"Cannot sort the given nodes.\");\n    } else {\n      return 0;\n    }\n  });\n}\nvar isElement = function isElement(el) {\n  return typeof el == \"object\" && \"nodeType\" in el && el.nodeType === Node.ELEMENT_NODE;\n};\nfunction getNextIndex(current, max, loop) {\n  var next = current + 1;\n  if (loop && next >= max) next = 0;\n  return next;\n}\nfunction getPrevIndex(current, max, loop) {\n  var next = current - 1;\n  if (loop && next < 0) next = max;\n  return next;\n}\nvar useSafeLayoutEffect = typeof window !== \"undefined\" ? useLayoutEffect : useEffect;\nvar cast = function cast(value) {\n  return value;\n};\n\n/**\n * @internal\n *\n * Class to manage descendants and their relative indices in the DOM.\n * It uses `node.compareDocumentPosition(...)` under the hood\n */\nvar DescendantsManager = function DescendantsManager() {\n  var _this = this;\n\n  this.descendants = new Map();\n\n  this.register = function (nodeOrOptions) {\n    if (nodeOrOptions == null) return;\n\n    if (isElement(nodeOrOptions)) {\n      return _this.registerNode(nodeOrOptions);\n    }\n\n    return function (node) {\n      _this.registerNode(node, nodeOrOptions);\n    };\n  };\n\n  this.unregister = function (node) {\n    _this.descendants[\"delete\"](node);\n\n    var sorted = sortNodes(Array.from(_this.descendants.keys()));\n\n    _this.assignIndex(sorted);\n  };\n\n  this.destroy = function () {\n    _this.descendants.clear();\n  };\n\n  this.assignIndex = function (descendants) {\n    _this.descendants.forEach(function (descendant) {\n      var index = descendants.indexOf(descendant.node);\n      descendant.index = index;\n      descendant.node.dataset[\"index\"] = descendant.index.toString();\n    });\n  };\n\n  this.count = function () {\n    return _this.descendants.size;\n  };\n\n  this.enabledCount = function () {\n    return _this.enabledValues().length;\n  };\n\n  this.values = function () {\n    var values = Array.from(_this.descendants.values());\n    return values.sort(function (a, b) {\n      return a.index - b.index;\n    });\n  };\n\n  this.enabledValues = function () {\n    return _this.values().filter(function (descendant) {\n      return !descendant.disabled;\n    });\n  };\n\n  this.item = function (index) {\n    if (_this.count() === 0) return undefined;\n    return _this.values()[index];\n  };\n\n  this.enabledItem = function (index) {\n    if (_this.enabledCount() === 0) return undefined;\n    return _this.enabledValues()[index];\n  };\n\n  this.first = function () {\n    return _this.item(0);\n  };\n\n  this.firstEnabled = function () {\n    return _this.enabledItem(0);\n  };\n\n  this.last = function () {\n    return _this.item(_this.descendants.size - 1);\n  };\n\n  this.lastEnabled = function () {\n    var lastIndex = _this.enabledValues().length - 1;\n    return _this.enabledItem(lastIndex);\n  };\n\n  this.indexOf = function (node) {\n    var _this$descendants$get, _this$descendants$get2;\n\n    if (!node) return -1;\n    return (_this$descendants$get = (_this$descendants$get2 = _this.descendants.get(node)) == null ? void 0 : _this$descendants$get2.index) != null ? _this$descendants$get : -1;\n  };\n\n  this.enabledIndexOf = function (node) {\n    if (node == null) return -1;\n    return _this.enabledValues().findIndex(function (i) {\n      return i.node.isSameNode(node);\n    });\n  };\n\n  this.next = function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n\n    var next = getNextIndex(index, _this.count(), loop);\n    return _this.item(next);\n  };\n\n  this.nextEnabled = function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n\n    var item = _this.item(index);\n\n    if (!item) return;\n\n    var enabledIndex = _this.enabledIndexOf(item.node);\n\n    var nextEnabledIndex = getNextIndex(enabledIndex, _this.enabledCount(), loop);\n    return _this.enabledItem(nextEnabledIndex);\n  };\n\n  this.prev = function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n\n    var prev = getPrevIndex(index, _this.count() - 1, loop);\n    return _this.item(prev);\n  };\n\n  this.prevEnabled = function (index, loop) {\n    if (loop === void 0) {\n      loop = true;\n    }\n\n    var item = _this.item(index);\n\n    if (!item) return;\n\n    var enabledIndex = _this.enabledIndexOf(item.node);\n\n    var prevEnabledIndex = getPrevIndex(enabledIndex, _this.enabledCount() - 1, loop);\n    return _this.enabledItem(prevEnabledIndex);\n  };\n\n  this.registerNode = function (node, options) {\n    if (!node || _this.descendants.has(node)) return;\n    var keys = Array.from(_this.descendants.keys()).concat(node);\n    var sorted = sortNodes(keys);\n\n    if (options != null && options.disabled) {\n      options.disabled = !!options.disabled;\n    }\n\n    var descendant = _extends({\n      node: node,\n      index: -1\n    }, options);\n\n    _this.descendants.set(node, descendant);\n\n    _this.assignIndex(sorted);\n  };\n};\n\n/**\n * @internal\n * React hook that initializes the DescendantsManager\n */\n\nfunction useDescendants() {\n  var descendants = useRef(new DescendantsManager());\n  useSafeLayoutEffect(function () {\n    return function () {\n      return descendants.current.destroy();\n    };\n  });\n  return descendants.current;\n}\n\n/* -------------------------------------------------------------------------------------------------\n * Descendants context to be used in component-land.\n  - Mount the `DescendantsContextProvider` at the root of the component\n  - Call `useDescendantsContext` anywhere you need access to the descendants information\n\n  NB:  I recommend using `createDescendantContext` below\n * -----------------------------------------------------------------------------------------------*/\nvar _createContext = createContext({\n  name: \"DescendantsProvider\",\n  errorMessage: \"useDescendantsContext must be used within DescendantsProvider\"\n}),\n    DescendantsContextProvider = _createContext[0],\n    useDescendantsContext = _createContext[1];\n/**\n * @internal\n * This hook provides information a descendant such as:\n * - Its index compared to other descendants\n * - ref callback to register the descendant\n * - Its enabled index compared to other enabled descendants\n */\n\n\nfunction useDescendant(options) {\n  var descendants = useDescendantsContext();\n\n  var _useState = useState(-1),\n      index = _useState[0],\n      setIndex = _useState[1];\n\n  var ref = useRef(null);\n  useSafeLayoutEffect(function () {\n    return function () {\n      if (!ref.current) return;\n      descendants.unregister(ref.current);\n    };\n  }, []);\n  useSafeLayoutEffect(function () {\n    if (!ref.current) return;\n    var dataIndex = Number(ref.current.dataset[\"index\"]);\n\n    if (index != dataIndex && !Number.isNaN(dataIndex)) {\n      setIndex(dataIndex);\n    }\n  });\n  var refCallback = options ? cast(descendants.register(options)) : cast(descendants.register);\n  return {\n    descendants: descendants,\n    index: index,\n    enabledIndex: descendants.enabledIndexOf(ref.current),\n    register: mergeRefs(refCallback, ref)\n  };\n}\n/* -------------------------------------------------------------------------------------------------\n * Function that provides strongly typed versions of the context provider and hooks above.\n   To be used in component-land\n * -----------------------------------------------------------------------------------------------*/\n\n\nfunction createDescendantContext() {\n  var ContextProvider = cast(DescendantsContextProvider);\n\n  var _useDescendantsContext = function _useDescendantsContext() {\n    return cast(useDescendantsContext());\n  };\n\n  var _useDescendant = function _useDescendant(options) {\n    return useDescendant(options);\n  };\n\n  var _useDescendants = function _useDescendants() {\n    return useDescendants();\n  };\n\n  return [// context provider\n  ContextProvider, // call this when you need to read from context\n  _useDescendantsContext, // descendants state information, to be called and passed to `ContextProvider`\n  _useDescendants, // descendant index information\n  _useDescendant];\n}\n\nexport { createDescendantContext, createDescendantContext as default };\n"],"names":["_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","sortNodes","nodes","sort","a","b","compare","compareDocumentPosition","Node","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_PRECEDING","DOCUMENT_POSITION_CONTAINS","DOCUMENT_POSITION_DISCONNECTED","DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC","Error","getNextIndex","current","max","loop","next","getPrevIndex","useSafeLayoutEffect","window","useLayoutEffect","useEffect","DescendantsManager","_this","descendants","Map","register","nodeOrOptions","el","nodeType","ELEMENT_NODE","registerNode","node","unregister","sorted","Array","from","keys","assignIndex","destroy","clear","forEach","descendant","index","indexOf","dataset","toString","count","size","enabledCount","enabledValues","values","filter","disabled","item","enabledItem","first","firstEnabled","last","lastEnabled","lastIndex","_this$descendants$get","_this$descendants$get2","get","enabledIndexOf","findIndex","isSameNode","nextEnabled","nextEnabledIndex","prev","prevEnabled","prevEnabledIndex","options","has","concat","set","_createContext","createContext","name","errorMessage","DescendantsContextProvider","useDescendantsContext","createDescendantContext","useRef","_useState","useState","setIndex","ref","dataIndex","Number","isNaN","refCallback","enabledIndex","mergeRefs","useDescendant"],"mappings":"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"}