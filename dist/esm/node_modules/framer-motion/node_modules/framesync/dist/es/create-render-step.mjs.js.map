{"version":3,"file":"create-render-step.mjs.js","sources":["../../../../../../../../node_modules/framer-motion/node_modules/framesync/dist/es/create-render-step.mjs"],"sourcesContent":["function createRenderStep(runNextFrame) {\n    let toRun = [];\n    let toRunNextFrame = [];\n    let numToRun = 0;\n    let isProcessing = false;\n    let flushNextFrame = false;\n    const toKeepAlive = new WeakSet();\n    const step = {\n        schedule: (callback, keepAlive = false, immediate = false) => {\n            const addToCurrentFrame = immediate && isProcessing;\n            const buffer = addToCurrentFrame ? toRun : toRunNextFrame;\n            if (keepAlive)\n                toKeepAlive.add(callback);\n            if (buffer.indexOf(callback) === -1) {\n                buffer.push(callback);\n                if (addToCurrentFrame && isProcessing)\n                    numToRun = toRun.length;\n            }\n            return callback;\n        },\n        cancel: (callback) => {\n            const index = toRunNextFrame.indexOf(callback);\n            if (index !== -1)\n                toRunNextFrame.splice(index, 1);\n            toKeepAlive.delete(callback);\n        },\n        process: (frameData) => {\n            if (isProcessing) {\n                flushNextFrame = true;\n                return;\n            }\n            isProcessing = true;\n            [toRun, toRunNextFrame] = [toRunNextFrame, toRun];\n            toRunNextFrame.length = 0;\n            numToRun = toRun.length;\n            if (numToRun) {\n                for (let i = 0; i < numToRun; i++) {\n                    const callback = toRun[i];\n                    callback(frameData);\n                    if (toKeepAlive.has(callback)) {\n                        step.schedule(callback);\n                        runNextFrame();\n                    }\n                }\n            }\n            isProcessing = false;\n            if (flushNextFrame) {\n                flushNextFrame = false;\n                step.process(frameData);\n            }\n        },\n    };\n    return step;\n}\n\nexport { createRenderStep };\n"],"names":["createRenderStep","runNextFrame","toRun","toRunNextFrame","numToRun","isProcessing","flushNextFrame","toKeepAlive","WeakSet","step","schedule","callback","keepAlive","immediate","addToCurrentFrame","buffer","add","indexOf","push","length","cancel","index","splice","delete","process","frameData","i","has"],"mappings":"AAAA,SAASA,EAAiBC,GACtB,IAAIC,EAAQ,GACRC,EAAiB,GACjBC,EAAW,EACXC,GAAe,EACfC,GAAiB,EACrB,MAAMC,EAAc,IAAIC,QAClBC,EAAO,CACTC,SAAU,CAACC,EAAUC,GAAY,EAAOC,GAAY,KAChD,MAAMC,EAAoBD,GAAaR,EACjCU,EAASD,EAAoBZ,EAAQC,EAQ3C,OAPIS,GACAL,EAAYS,IAAIL,IACc,IAA9BI,EAAOE,QAAQN,KACfI,EAAOG,KAAKP,GACRG,GAAqBT,IACrBD,EAAWF,EAAMiB,SAElBR,CAAQ,EAEnBS,OAAST,IACL,MAAMU,EAAQlB,EAAec,QAAQN,IACtB,IAAXU,GACAlB,EAAemB,OAAOD,EAAO,GACjCd,EAAYgB,OAAOZ,EAAS,EAEhCa,QAAUC,IACN,GAAIpB,EACAC,GAAiB,MADrB,CAQA,GAJAD,GAAe,GACdH,EAAOC,GAAkB,CAACA,EAAgBD,GAC3CC,EAAegB,OAAS,EACxBf,EAAWF,EAAMiB,OACbf,EACA,IAAK,IAAIsB,EAAI,EAAGA,EAAItB,EAAUsB,IAAK,CAC/B,MAAMf,EAAWT,EAAMwB,GACvBf,EAASc,GACLlB,EAAYoB,IAAIhB,KAChBF,EAAKC,SAASC,GACdV,IAEP,CAELI,GAAe,EACXC,IACAA,GAAiB,EACjBG,EAAKe,QAAQC,GAlBhB,CAmBA,GAGT,OAAOhB,CACX"}