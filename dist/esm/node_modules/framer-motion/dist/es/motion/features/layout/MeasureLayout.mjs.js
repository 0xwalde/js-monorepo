import{__extends as o,__assign as e,__read as t}from"../../../../../../tslib/tslib.es6.js";import r from"../../../../../node_modules/framesync/dist/es/index.mjs.js";import s from"../../../../../../react/index.js";import{usePresence as n}from"../../../components/AnimatePresence/use-presence.mjs.js";import{LayoutGroupContext as i}from"../../../context/LayoutGroupContext.mjs.js";import{SwitchLayoutGroupContext as p}from"../../../context/SwitchLayoutGroupContext.mjs.js";import{globalProjectionState as u}from"../../../projection/node/state.mjs.js";import{correctBorderRadius as a}from"../../../projection/styles/scale-border-radius.mjs.js";import{correctBoxShadow as m}from"../../../projection/styles/scale-box-shadow.mjs.js";import{addScaleCorrector as d}from"../../../projection/styles/scale-correction.mjs.js";import{r as l}from"../../../../../../../_virtual/index.js";var c=function(t){function s(){return null!==t&&t.apply(this,arguments)||this}return o(s,t),s.prototype.componentDidMount=function(){var o=this,t=this.props,r=t.visualElement,s=t.layoutGroup,n=t.switchLayoutGroup,i=t.layoutId,p=r.projection;d(v),p&&((null==s?void 0:s.group)&&s.group.add(p),(null==n?void 0:n.register)&&i&&n.register(p),p.root.didUpdate(),p.addEventListener("animationComplete",(function(){o.safeToRemove()})),p.setOptions(e(e({},p.options),{onExitComplete:function(){return o.safeToRemove()}}))),u.hasEverUpdated=!0},s.prototype.getSnapshotBeforeUpdate=function(o){var e=this,t=this.props,s=t.layoutDependency,n=t.visualElement,i=t.drag,p=t.isPresent,u=n.projection;return u?(u.isPresent=p,i||o.layoutDependency!==s||void 0===s?u.willUpdate():this.safeToRemove(),o.isPresent!==p&&(p?u.promote():u.relegate()||r.postRender((function(){var o;(null===(o=u.getStack())||void 0===o?void 0:o.members.length)||e.safeToRemove()}))),null):null},s.prototype.componentDidUpdate=function(){var o=this.props.visualElement.projection;o&&(o.root.didUpdate(),!o.currentAnimation&&o.isLead()&&this.safeToRemove())},s.prototype.componentWillUnmount=function(){var o=this.props,e=o.visualElement,t=o.layoutGroup,r=o.switchLayoutGroup,s=e.projection;s&&(s.scheduleCheckAfterUnmount(),(null==t?void 0:t.group)&&t.group.remove(s),(null==r?void 0:r.deregister)&&r.deregister(s))},s.prototype.safeToRemove=function(){var o=this.props.safeToRemove;null==o||o()},s.prototype.render=function(){return null},s}(s.Component);function f(o){var r=t(n(),2),u=r[0],a=r[1],m=l.exports.useContext(i);return s.createElement(c,e({},o,{layoutGroup:m,switchLayoutGroup:l.exports.useContext(p),isPresent:u,safeToRemove:a}))}var v={borderRadius:e(e({},a),{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:a,borderTopRightRadius:a,borderBottomLeftRadius:a,borderBottomRightRadius:a,boxShadow:m};export{f as MeasureLayout};
//# sourceMappingURL=MeasureLayout.mjs.js.map
