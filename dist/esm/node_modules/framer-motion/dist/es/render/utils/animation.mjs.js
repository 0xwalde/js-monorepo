import{__read as r,__rest as t,__assign as n}from"../../../../../tslib/tslib.es6.js";import{startAnimation as i}from"../../animation/utils/transitions.mjs.js";import{setTarget as o}from"./setters.mjs.js";import{resolveVariant as e}from"./variants.mjs.js";import{isTransformProp as a}from"../html/utils/transform.mjs.js";function s(r,t,n){var i;if(void 0===n&&(n={}),r.notifyAnimationStart(t),Array.isArray(t)){var o=t.map((function(t){return u(r,t,n)}));i=Promise.all(o)}else if("string"==typeof t)i=u(r,t,n);else{var a="function"==typeof t?e(r,t,n.custom):t;i=v(r,a,n)}return i.then((function(){return r.notifyAnimationComplete(t)}))}function u(t,i,o){var a;void 0===o&&(o={});var s=e(t,i,o.custom),l=(s||{}).transition,f=void 0===l?t.getDefaultTransition()||{}:l;o.transitionOverride&&(f=o.transitionOverride);var m=s?function(){return v(t,s,o)}:function(){return Promise.resolve()},c=(null===(a=t.variantChildren)||void 0===a?void 0:a.size)?function(r){void 0===r&&(r=0);var e=f.delayChildren,a=void 0===e?0:e,s=f.staggerChildren,v=f.staggerDirection;return function(r,t,i,o,e,a){void 0===i&&(i=0);void 0===o&&(o=0);void 0===e&&(e=1);var s=[],v=(r.variantChildren.size-1)*o,l=1===e?function(r){return void 0===r&&(r=0),r*o}:function(r){return void 0===r&&(r=0),v-r*o};return Array.from(r.variantChildren).sort(d).forEach((function(r,o){s.push(u(r,t,n(n({},a),{delay:i+l(o)})).then((function(){return r.notifyAnimationComplete(t)})))})),Promise.all(s)}(t,i,a+r,s,v,o)}:function(){return Promise.resolve()},y=f.when;if(y){var h=r("beforeChildren"===y?[m,c]:[c,m],2),p=h[0],g=h[1];return p().then(g)}return Promise.all([m(),c(o.delay)])}function v(r,e,s){var u,v=void 0===s?{}:s,d=v.delay,f=void 0===d?0:d,m=v.transitionOverride,c=v.type,y=r.makeTargetAnimatable(e),h=y.transition,p=void 0===h?r.getDefaultTransition():h,g=y.transitionEnd,j=t(y,["transition","transitionEnd"]);m&&(p=m);var A=[],C=c&&(null===(u=r.animationState)||void 0===u?void 0:u.getState()[c]);for(var P in j){var b=r.getValue(P),O=j[P];if(!(!b||void 0===O||C&&l(C,P))){var D=n({delay:f},p);r.shouldReduceMotion&&a(P)&&(D=n(n({},D),{type:!1,delay:0}));var E=i(P,b,O,D);A.push(E)}}return Promise.all(A).then((function(){g&&o(r,g)}))}function d(r,t){return r.sortNodePosition(t)}function l(r,t){var n=r.protectedKeys,i=r.needsAnimating,o=n.hasOwnProperty(t)&&!0!==i[t];return i[t]=!1,o}export{s as animateVisualElement,d as sortByTreeOrder};
//# sourceMappingURL=animation.mjs.js.map
