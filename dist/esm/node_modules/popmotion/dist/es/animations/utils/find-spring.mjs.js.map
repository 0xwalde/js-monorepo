{"version":3,"file":"find-spring.mjs.js","sources":["../../../../../../../../node_modules/popmotion/dist/es/animations/utils/find-spring.mjs"],"sourcesContent":["import { warning } from 'hey-listen';\nimport { clamp } from '../../utils/clamp.mjs';\n\nconst safeMin = 0.001;\nconst minDuration = 0.01;\nconst maxDuration = 10.0;\nconst minDamping = 0.05;\nconst maxDamping = 1;\nfunction findSpring({ duration = 800, bounce = 0.25, velocity = 0, mass = 1, }) {\n    let envelope;\n    let derivative;\n    warning(duration <= maxDuration * 1000, \"Spring duration must be 10 seconds or less\");\n    let dampingRatio = 1 - bounce;\n    dampingRatio = clamp(minDamping, maxDamping, dampingRatio);\n    duration = clamp(minDuration, maxDuration, duration / 1000);\n    if (dampingRatio < 1) {\n        envelope = (undampedFreq) => {\n            const exponentialDecay = undampedFreq * dampingRatio;\n            const delta = exponentialDecay * duration;\n            const a = exponentialDecay - velocity;\n            const b = calcAngularFreq(undampedFreq, dampingRatio);\n            const c = Math.exp(-delta);\n            return safeMin - (a / b) * c;\n        };\n        derivative = (undampedFreq) => {\n            const exponentialDecay = undampedFreq * dampingRatio;\n            const delta = exponentialDecay * duration;\n            const d = delta * velocity + velocity;\n            const e = Math.pow(dampingRatio, 2) * Math.pow(undampedFreq, 2) * duration;\n            const f = Math.exp(-delta);\n            const g = calcAngularFreq(Math.pow(undampedFreq, 2), dampingRatio);\n            const factor = -envelope(undampedFreq) + safeMin > 0 ? -1 : 1;\n            return (factor * ((d - e) * f)) / g;\n        };\n    }\n    else {\n        envelope = (undampedFreq) => {\n            const a = Math.exp(-undampedFreq * duration);\n            const b = (undampedFreq - velocity) * duration + 1;\n            return -safeMin + a * b;\n        };\n        derivative = (undampedFreq) => {\n            const a = Math.exp(-undampedFreq * duration);\n            const b = (velocity - undampedFreq) * (duration * duration);\n            return a * b;\n        };\n    }\n    const initialGuess = 5 / duration;\n    const undampedFreq = approximateRoot(envelope, derivative, initialGuess);\n    duration = duration * 1000;\n    if (isNaN(undampedFreq)) {\n        return {\n            stiffness: 100,\n            damping: 10,\n            duration,\n        };\n    }\n    else {\n        const stiffness = Math.pow(undampedFreq, 2) * mass;\n        return {\n            stiffness,\n            damping: dampingRatio * 2 * Math.sqrt(mass * stiffness),\n            duration,\n        };\n    }\n}\nconst rootIterations = 12;\nfunction approximateRoot(envelope, derivative, initialGuess) {\n    let result = initialGuess;\n    for (let i = 1; i < rootIterations; i++) {\n        result = result - envelope(result) / derivative(result);\n    }\n    return result;\n}\nfunction calcAngularFreq(undampedFreq, dampingRatio) {\n    return undampedFreq * Math.sqrt(1 - dampingRatio * dampingRatio);\n}\n\nexport { calcAngularFreq, findSpring, maxDamping, maxDuration, minDamping, minDuration };\n"],"names":["minDuration","maxDuration","minDamping","maxDamping","findSpring","duration","bounce","velocity","mass","envelope","derivative","warning","dampingRatio","clamp","undampedFreq","exponentialDecay","delta","calcAngularFreq","Math","exp","d","e","pow","f","g","initialGuess","result","i","approximateRoot","isNaN","stiffness","damping","sqrt"],"mappings":"2HAGA,MACMA,EAAc,IACdC,EAAc,GACdC,EAAa,IACbC,EAAa,EACnB,SAASC,GAAWC,SAAEA,EAAW,IAAGC,OAAEA,EAAS,IAAIC,SAAEA,EAAW,EAACC,KAAEA,EAAO,IACtE,IAAIC,EACAC,EACJC,EAAQN,GAAYJ,IAAoB,8CACxC,IAAIW,EAAe,EAAIN,EACvBM,EAAeC,EAPA,IACA,EAM8BD,GAC7CP,EAAWQ,EAVK,IACA,GAS2BR,EAAW,KAClDO,EAAe,GACfH,EAAYK,IACR,MAAMC,EAAmBD,EAAeF,EAClCI,EAAQD,EAAmBV,EAIjC,MAnBI,MAgBMU,EAAmBR,GACnBU,EAAgBH,EAAcF,GAC9BM,KAAKC,KAAKH,EACQ,EAEhCN,EAAcI,IACV,MACME,EADmBF,EAAeF,EACPP,EAC3Be,EAAIJ,EAAQT,EAAWA,EACvBc,EAAIH,KAAKI,IAAIV,EAAc,GAAKM,KAAKI,IAAIR,EAAc,GAAKT,EAC5DkB,EAAIL,KAAKC,KAAKH,GACdQ,EAAIP,EAAgBC,KAAKI,IAAIR,EAAc,GAAIF,GAErD,OA7BI,KA4BYH,EAASK,GAA0B,GAAK,EAAI,KACzCM,EAAIC,GAAKE,GAAMC,CAAC,IAIvCf,EAAYK,GACEI,KAAKC,KAAKL,EAAeT,KACxBS,EAAeP,GAAYF,EAAW,GAnC7C,KAsCRK,EAAcI,GACAI,KAAKC,KAAKL,EAAeT,IACIA,EAAWA,GAAvCE,EAAWO,KAI9B,MACMA,EAmBV,SAAyBL,EAAUC,EAAYe,GAC3C,IAAIC,EAASD,EACb,IAAK,IAAIE,EAAI,EAAGA,EAHG,GAGiBA,IAChCD,GAAkBjB,EAASiB,GAAUhB,EAAWgB,GAEpD,OAAOA,CACX,CAzByBE,CAAgBnB,EAAUC,EAD1B,EAAIL,GAGzB,GADAA,GAAsB,IAClBwB,MAAMf,GACN,MAAO,CACHgB,UAAW,IACXC,QAAS,GACT1B,YAGH,CACD,MAAMyB,EAAYZ,KAAKI,IAAIR,EAAc,GAAKN,EAC9C,MAAO,CACHsB,YACAC,QAAwB,EAAfnB,EAAmBM,KAAKc,KAAKxB,EAAOsB,GAC7CzB,WAEP,CACL,CASA,SAASY,EAAgBH,EAAcF,GACnC,OAAOE,EAAeI,KAAKc,KAAK,EAAIpB,EAAeA,EACvD"}