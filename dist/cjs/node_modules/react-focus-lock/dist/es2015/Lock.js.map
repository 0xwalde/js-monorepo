{"version":3,"file":"Lock.js","sources":["../../../../../../node_modules/react-focus-lock/dist/es2015/Lock.js"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { node, bool, string, any, arrayOf, oneOfType, object, func } from 'prop-types';\nimport * as constants from 'focus-lock/constants';\nimport { useMergeRefs } from 'use-callback-ref';\nimport { useEffect } from 'react';\nimport { hiddenGuard } from './FocusGuard';\nimport { mediumFocus, mediumBlur, mediumSidecar } from './medium';\nvar emptyArray = [];\nvar FocusLock = /*#__PURE__*/React.forwardRef(function FocusLockUI(props, parentRef) {\n  var _extends2;\n\n  var _React$useState = React.useState(),\n      realObserved = _React$useState[0],\n      setObserved = _React$useState[1];\n\n  var observed = React.useRef();\n  var isActive = React.useRef(false);\n  var originalFocusedElement = React.useRef(null);\n  var children = props.children,\n      disabled = props.disabled,\n      noFocusGuards = props.noFocusGuards,\n      persistentFocus = props.persistentFocus,\n      crossFrame = props.crossFrame,\n      autoFocus = props.autoFocus,\n      allowTextSelection = props.allowTextSelection,\n      group = props.group,\n      className = props.className,\n      whiteList = props.whiteList,\n      hasPositiveIndices = props.hasPositiveIndices,\n      _props$shards = props.shards,\n      shards = _props$shards === void 0 ? emptyArray : _props$shards,\n      _props$as = props.as,\n      Container = _props$as === void 0 ? 'div' : _props$as,\n      _props$lockProps = props.lockProps,\n      containerProps = _props$lockProps === void 0 ? {} : _props$lockProps,\n      SideCar = props.sideCar,\n      shouldReturnFocus = props.returnFocus,\n      focusOptions = props.focusOptions,\n      onActivationCallback = props.onActivation,\n      onDeactivationCallback = props.onDeactivation;\n\n  var _React$useState2 = React.useState({}),\n      id = _React$useState2[0]; // SIDE EFFECT CALLBACKS\n\n\n  var onActivation = React.useCallback(function () {\n    originalFocusedElement.current = originalFocusedElement.current || document && document.activeElement;\n\n    if (observed.current && onActivationCallback) {\n      onActivationCallback(observed.current);\n    }\n\n    isActive.current = true;\n  }, [onActivationCallback]);\n  var onDeactivation = React.useCallback(function () {\n    isActive.current = false;\n\n    if (onDeactivationCallback) {\n      onDeactivationCallback(observed.current);\n    }\n  }, [onDeactivationCallback]);\n  useEffect(function () {\n    if (!disabled) {\n      // cleanup return focus on trap deactivation\n      // sideEffect/returnFocus should happen by this time\n      originalFocusedElement.current = null;\n    }\n  }, []);\n  var returnFocus = React.useCallback(function (allowDefer) {\n    var returnFocusTo = originalFocusedElement.current;\n\n    if (returnFocusTo && returnFocusTo.focus) {\n      var howToReturnFocus = typeof shouldReturnFocus === 'function' ? shouldReturnFocus(returnFocusTo) : shouldReturnFocus;\n\n      if (howToReturnFocus) {\n        var returnFocusOptions = typeof howToReturnFocus === 'object' ? howToReturnFocus : undefined;\n        originalFocusedElement.current = null;\n\n        if (allowDefer) {\n          // React might return focus after update\n          // it's safer to defer the action\n          Promise.resolve().then(function () {\n            return returnFocusTo.focus(returnFocusOptions);\n          });\n        } else {\n          returnFocusTo.focus(returnFocusOptions);\n        }\n      }\n    }\n  }, [shouldReturnFocus]); // MEDIUM CALLBACKS\n\n  var onFocus = React.useCallback(function (event) {\n    if (isActive.current) {\n      mediumFocus.useMedium(event);\n    }\n  }, []);\n  var onBlur = mediumBlur.useMedium; // REF PROPAGATION\n  // not using real refs due to race conditions\n\n  var setObserveNode = React.useCallback(function (newObserved) {\n    if (observed.current !== newObserved) {\n      observed.current = newObserved;\n      setObserved(newObserved);\n    }\n  }, []);\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof allowTextSelection !== 'undefined') {\n      // eslint-disable-next-line no-console\n      console.warn('React-Focus-Lock: allowTextSelection is deprecated and enabled by default');\n    }\n\n    React.useEffect(function () {\n      if (!observed.current) {\n        // eslint-disable-next-line no-console\n        console.error('FocusLock: could not obtain ref to internal node');\n      }\n    }, []);\n  }\n\n  var lockProps = _extends((_extends2 = {}, _extends2[constants.FOCUS_DISABLED] = disabled && 'disabled', _extends2[constants.FOCUS_GROUP] = group, _extends2), containerProps);\n\n  var hasLeadingGuards = noFocusGuards !== true;\n  var hasTailingGuards = hasLeadingGuards && noFocusGuards !== 'tail';\n  var mergedRef = useMergeRefs([parentRef, setObserveNode]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, hasLeadingGuards && [\n  /*#__PURE__*/\n  // nearest focus guard\n  React.createElement(\"div\", {\n    key: \"guard-first\",\n    \"data-focus-guard\": true,\n    tabIndex: disabled ? -1 : 0,\n    style: hiddenGuard\n  }), // first tabbed element guard\n  hasPositiveIndices ? /*#__PURE__*/React.createElement(\"div\", {\n    key: \"guard-nearest\",\n    \"data-focus-guard\": true,\n    tabIndex: disabled ? -1 : 1,\n    style: hiddenGuard\n  }) : null], !disabled && /*#__PURE__*/React.createElement(SideCar, {\n    id: id,\n    sideCar: mediumSidecar,\n    observed: realObserved,\n    disabled: disabled,\n    persistentFocus: persistentFocus,\n    crossFrame: crossFrame,\n    autoFocus: autoFocus,\n    whiteList: whiteList,\n    shards: shards,\n    onActivation: onActivation,\n    onDeactivation: onDeactivation,\n    returnFocus: returnFocus,\n    focusOptions: focusOptions\n  }), /*#__PURE__*/React.createElement(Container, _extends({\n    ref: mergedRef\n  }, lockProps, {\n    className: className,\n    onBlur: onBlur,\n    onFocus: onFocus\n  }), children), hasTailingGuards && /*#__PURE__*/React.createElement(\"div\", {\n    \"data-focus-guard\": true,\n    tabIndex: disabled ? -1 : 0,\n    style: hiddenGuard\n  }));\n});\nFocusLock.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  children: node,\n  disabled: bool,\n  returnFocus: oneOfType([bool, object, func]),\n  focusOptions: object,\n  noFocusGuards: bool,\n  hasPositiveIndices: bool,\n  allowTextSelection: bool,\n  autoFocus: bool,\n  persistentFocus: bool,\n  crossFrame: bool,\n  group: string,\n  className: string,\n  whiteList: func,\n  shards: arrayOf(any),\n  as: oneOfType([string, func, object]),\n  lockProps: object,\n  onActivation: func,\n  onDeactivation: func,\n  sideCar: any.isRequired\n} : {};\nFocusLock.defaultProps = {\n  children: undefined,\n  disabled: false,\n  returnFocus: false,\n  focusOptions: undefined,\n  noFocusGuards: false,\n  autoFocus: true,\n  persistentFocus: false,\n  crossFrame: true,\n  hasPositiveIndices: undefined,\n  allowTextSelection: undefined,\n  group: undefined,\n  className: undefined,\n  whiteList: undefined,\n  shards: undefined,\n  as: 'div',\n  lockProps: {},\n  onActivation: undefined,\n  onDeactivation: undefined\n};\nexport default FocusLock;"],"names":["emptyArray","FocusLock","React.forwardRef","props","parentRef","_extends2","_React$useState","React.useState","realObserved","setObserved","observed","React.useRef","isActive","originalFocusedElement","children","disabled","noFocusGuards","persistentFocus","crossFrame","autoFocus","allowTextSelection","group","className","whiteList","hasPositiveIndices","_props$shards","shards","_props$as","as","Container","_props$lockProps","lockProps","containerProps","SideCar","sideCar","shouldReturnFocus","returnFocus","focusOptions","onActivationCallback","onActivation","onDeactivationCallback","onDeactivation","id","react","exports","useState","React.useCallback","current","document","activeElement","useEffect","allowDefer","returnFocusTo","focus","howToReturnFocus","returnFocusOptions","undefined","Promise","resolve","then","onFocus","event","mediumFocus","useMedium","onBlur","mediumBlur","setObserveNode","newObserved","process","env","NODE_ENV","console","warn","React.useEffect","error","_extends","constants.FOCUS_DISABLED","constants.FOCUS_GROUP","FOCUS_GROUP","hasLeadingGuards","hasTailingGuards","mergedRef","useMergeRefs","React.createElement","React.Fragment","key","tabIndex","style","hiddenGuard","createElement","mediumSidecar","ref","propTypes","node","bool","oneOfType","object","func","string","arrayOf","any","isRequired","defaultProps"],"mappings":"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"}