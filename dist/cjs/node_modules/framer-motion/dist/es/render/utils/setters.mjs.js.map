{"version":3,"file":"setters.mjs.js","sources":["../../../../../../../../node_modules/framer-motion/dist/es/render/utils/setters.mjs"],"sourcesContent":["import { __rest, __assign, __spreadArray, __read } from 'tslib';\nimport { complex } from 'style-value-types';\nimport { isNumericalString } from '../../utils/is-numerical-string.mjs';\nimport { isZeroValueString } from '../../utils/is-zero-value-string.mjs';\nimport { resolveFinalValueInKeyframes } from '../../utils/resolve-value.mjs';\nimport { motionValue } from '../../value/index.mjs';\nimport { getAnimatableNone } from '../dom/value-types/animatable-none.mjs';\nimport { findValueType } from '../dom/value-types/find.mjs';\nimport { resolveVariant } from './variants.mjs';\n\n/**\n * Set VisualElement's MotionValue, creating a new MotionValue for it if\n * it doesn't exist.\n */\nfunction setMotionValue(visualElement, key, value) {\n    if (visualElement.hasValue(key)) {\n        visualElement.getValue(key).set(value);\n    }\n    else {\n        visualElement.addValue(key, motionValue(value));\n    }\n}\nfunction setTarget(visualElement, definition) {\n    var resolved = resolveVariant(visualElement, definition);\n    var _a = resolved ? visualElement.makeTargetAnimatable(resolved, false) : {}, _b = _a.transitionEnd, transitionEnd = _b === void 0 ? {} : _b; _a.transition; var target = __rest(_a, [\"transitionEnd\", \"transition\"]);\n    target = __assign(__assign({}, target), transitionEnd);\n    for (var key in target) {\n        var value = resolveFinalValueInKeyframes(target[key]);\n        setMotionValue(visualElement, key, value);\n    }\n}\nfunction setVariants(visualElement, variantLabels) {\n    var reversedLabels = __spreadArray([], __read(variantLabels), false).reverse();\n    reversedLabels.forEach(function (key) {\n        var _a;\n        var variant = visualElement.getVariant(key);\n        variant && setTarget(visualElement, variant);\n        (_a = visualElement.variantChildren) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {\n            setVariants(child, variantLabels);\n        });\n    });\n}\nfunction setValues(visualElement, definition) {\n    if (Array.isArray(definition)) {\n        return setVariants(visualElement, definition);\n    }\n    else if (typeof definition === \"string\") {\n        return setVariants(visualElement, [definition]);\n    }\n    else {\n        setTarget(visualElement, definition);\n    }\n}\nfunction checkTargetForNewValues(visualElement, target, origin) {\n    var _a, _b, _c;\n    var _d;\n    var newValueKeys = Object.keys(target).filter(function (key) { return !visualElement.hasValue(key); });\n    var numNewValues = newValueKeys.length;\n    if (!numNewValues)\n        return;\n    for (var i = 0; i < numNewValues; i++) {\n        var key = newValueKeys[i];\n        var targetValue = target[key];\n        var value = null;\n        /**\n         * If the target is a series of keyframes, we can use the first value\n         * in the array. If this first value is null, we'll still need to read from the DOM.\n         */\n        if (Array.isArray(targetValue)) {\n            value = targetValue[0];\n        }\n        /**\n         * If the target isn't keyframes, or the first keyframe was null, we need to\n         * first check if an origin value was explicitly defined in the transition as \"from\",\n         * if not read the value from the DOM. As an absolute fallback, take the defined target value.\n         */\n        if (value === null) {\n            value = (_b = (_a = origin[key]) !== null && _a !== void 0 ? _a : visualElement.readValue(key)) !== null && _b !== void 0 ? _b : target[key];\n        }\n        /**\n         * If value is still undefined or null, ignore it. Preferably this would throw,\n         * but this was causing issues in Framer.\n         */\n        if (value === undefined || value === null)\n            continue;\n        if (typeof value === \"string\" &&\n            (isNumericalString(value) || isZeroValueString(value))) {\n            // If this is a number read as a string, ie \"0\" or \"200\", convert it to a number\n            value = parseFloat(value);\n        }\n        else if (!findValueType(value) && complex.test(targetValue)) {\n            value = getAnimatableNone(key, targetValue);\n        }\n        visualElement.addValue(key, motionValue(value));\n        (_c = (_d = origin)[key]) !== null && _c !== void 0 ? _c : (_d[key] = value);\n        visualElement.setBaseTarget(key, value);\n    }\n}\nfunction getOriginFromTransition(key, transition) {\n    if (!transition)\n        return;\n    var valueTransition = transition[key] || transition[\"default\"] || transition;\n    return valueTransition.from;\n}\nfunction getOrigin(target, transition, visualElement) {\n    var _a, _b;\n    var origin = {};\n    for (var key in target) {\n        origin[key] =\n            (_a = getOriginFromTransition(key, transition)) !== null && _a !== void 0 ? _a : (_b = visualElement.getValue(key)) === null || _b === void 0 ? void 0 : _b.get();\n    }\n    return origin;\n}\n\nexport { checkTargetForNewValues, getOrigin, getOriginFromTransition, setTarget, setValues };\n"],"names":["setMotionValue","visualElement","key","value","hasValue","getValue","set","addValue","motionValue","getOriginFromTransition","transition","from","target","origin","_a","_b","_c","_d","newValueKeys","Object","keys","filter","numNewValues","length","i","targetValue","Array","isArray","readValue","isNumericalString","isZeroValueString","parseFloat","findValueType","complex","test","getAnimatableNone","setBaseTarget","get","definition","resolved","resolveVariant","makeTargetAnimatable","transitionEnd","__rest","__assign","resolveFinalValueInKeyframes"],"mappings":"igBAcA,SAASA,EAAeC,EAAeC,EAAKC,GACpCF,EAAcG,SAASF,GACvBD,EAAcI,SAASH,GAAKI,IAAIH,GAGhCF,EAAcM,SAASL,EAAKM,EAAAA,YAAYL,GAEhD,CA6EA,SAASM,EAAwBP,EAAKQ,GAClC,GAAKA,EAGL,OADsBA,EAAWR,IAAQQ,EAAoB,SAAKA,GAC3CC,IAC3B,iCAlDA,SAAiCV,EAAeW,EAAQC,GACpD,IAAIC,EAAIC,EAAIC,EACRC,EACAC,EAAeC,OAAOC,KAAKR,GAAQS,QAAO,SAAUnB,GAAO,OAAQD,EAAcG,SAASF,EAAO,IACjGoB,EAAeJ,EAAaK,OAChC,GAAKD,EAEL,IAAK,IAAIE,EAAI,EAAGA,EAAIF,EAAcE,IAAK,CACnC,IAAItB,EAAMgB,EAAaM,GACnBC,EAAcb,EAAOV,GACrBC,EAAQ,KAKRuB,MAAMC,QAAQF,KACdtB,EAAQsB,EAAY,IAOV,OAAVtB,IACAA,EAAoG,QAA3FY,EAA4B,QAAtBD,EAAKD,EAAOX,UAAyB,IAAPY,EAAgBA,EAAKb,EAAc2B,UAAU1B,UAAyB,IAAPa,EAAgBA,EAAKH,EAAOV,IAMxIC,UAEiB,iBAAVA,IACN0B,EAAAA,kBAAkB1B,IAAU2B,oBAAkB3B,IAE/CA,EAAQ4B,WAAW5B,IAEb6B,EAAaA,cAAC7B,IAAU8B,EAAAA,QAAQC,KAAKT,KAC3CtB,EAAQgC,EAAiBA,kBAACjC,EAAKuB,IAEnCxB,EAAcM,SAASL,EAAKM,EAAAA,YAAYL,IACV,QAA7Ba,GAAMC,EAAKJ,GAAQX,UAAyB,IAAPc,IAAsBC,EAAGf,GAAOC,GACtEF,EAAcmC,cAAclC,EAAKC,GACpC,CACL,oBAOA,SAAmBS,EAAQF,EAAYT,GACnC,IAAIa,EAAIC,EACJF,EAAS,CAAA,EACb,IAAK,IAAIX,KAAOU,EACZC,EAAOX,GACiD,QAAnDY,EAAKL,EAAwBP,EAAKQ,UAAgC,IAAPI,EAAgBA,EAA4C,QAAtCC,EAAKd,EAAcI,SAASH,UAAyB,IAAPa,OAAgB,EAASA,EAAGsB,MAEpK,OAAOxB,CACX,sDA1FA,SAAmBZ,EAAeqC,GAC9B,IAAIC,EAAWC,EAAAA,eAAevC,EAAeqC,GACzCxB,EAAKyB,EAAWtC,EAAcwC,qBAAqBF,GAAU,GAAS,CAAA,EAAIxB,EAAKD,EAAG4B,cAAeA,OAAuB,IAAP3B,EAAgB,CAAE,EAAGA,EAAID,EAAGJ,WAAY,IAAIE,EAAS+B,EAAAA,OAAO7B,EAAI,CAAC,gBAAiB,eAEvM,IAAK,IAAIZ,KADTU,EAASgC,EAAQA,SAACA,EAAQA,SAAC,CAAE,EAAEhC,GAAS8B,GAChB,CAEpB1C,EAAeC,EAAeC,EADlB2C,EAA4BA,6BAACjC,EAAOV,IAEnD,CACL"}