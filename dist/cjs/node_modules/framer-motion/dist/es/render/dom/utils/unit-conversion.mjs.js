"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("../../../../../../tslib/tslib.es6.js"),n=require("../../../animation/utils/is-keyframes-target.mjs.js"),r=require("../../../../../../hey-listen/dist/hey-listen.es.js"),i=require("../../html/utils/transform.mjs.js"),a=require("../value-types/dimensions.mjs.js"),s=require("../../../../../../style-value-types/dist/es/numbers/units.mjs.js"),o=require("../../../../../../style-value-types/dist/es/numbers/index.mjs.js"),u=new Set(["width","height","top","left","right","bottom","x","y"]),l=function(e){return u.has(e)},f=function(e,t){e.set(t,!1),e.set(t)},m=function(e){return e===o.number||e===s.px};exports.BoundingBoxDimension=void 0,(e=exports.BoundingBoxDimension||(exports.BoundingBoxDimension={})).width="width",e.height="height",e.left="left",e.right="right",e.top="top",e.bottom="bottom";var p=function(e,t){return parseFloat(e.split(", ")[t])},d=function(e,t){return function(n,r){var i=r.transform;if("none"===i||!i)return 0;var a=i.match(/^matrix3d\((.+)\)$/);if(a)return p(a[1],t);var s=i.match(/^matrix\((.+)\)$/);return s?p(s[1],e):0}},v=new Set(["x","y","z"]),c=i.transformProps.filter((function(e){return!v.has(e)}));var h={width:function(e,t){var n=e.x,r=t.paddingLeft,i=void 0===r?"0":r,a=t.paddingRight,s=void 0===a?"0":a;return n.max-n.min-parseFloat(i)-parseFloat(s)},height:function(e,t){var n=e.y,r=t.paddingTop,i=void 0===r?"0":r,a=t.paddingBottom,s=void 0===a?"0":a;return n.max-n.min-parseFloat(i)-parseFloat(s)},top:function(e,t){var n=t.top;return parseFloat(n)},left:function(e,t){var n=t.left;return parseFloat(n)},bottom:function(e,t){var n=e.y,r=t.top;return parseFloat(r)+(n.max-n.min)},right:function(e,t){var n=e.x,r=t.left;return parseFloat(r)+(n.max-n.min)},x:d(4,13),y:d(5,14)},g=function(e,i,o,u){void 0===o&&(o={}),void 0===u&&(u={}),i=t.__assign({},i),u=t.__assign({},u);var p=Object.keys(i).filter(l),d=[],v=!1,g=[];if(p.forEach((function(t){var l=e.getValue(t);if(e.hasValue(t)){var p,h=o[t],y=a.findDimensionValueType(h),x=i[t];if(n.isKeyframesTarget(x)){var b=x.length,j=null===x[0]?1:0;h=x[j],y=a.findDimensionValueType(h);for(var V=j;V<b;V++)p?r.invariant(a.findDimensionValueType(x[V])===p,"All keyframes must be of the same type"):(p=a.findDimensionValueType(x[V]),r.invariant(p===y||m(y)&&m(p),"Keyframes must be of the same dimension as the current value"))}else p=a.findDimensionValueType(x);if(y!==p)if(m(y)&&m(p)){var w=l.get();"string"==typeof w&&l.set(parseFloat(w)),"string"==typeof x?i[t]=parseFloat(x):Array.isArray(x)&&p===s.px&&(i[t]=x.map(parseFloat))}else(null==y?void 0:y.transform)&&(null==p?void 0:p.transform)&&(0===h||0===x)?0===h?l.set(p.transform(h)):i[t]=y.transform(x):(v||(d=function(e){var t=[];return c.forEach((function(n){var r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))})),t.length&&e.syncRender(),t}(e),v=!0),g.push(t),u[t]=void 0!==u[t]?u[t]:i[t],f(l,x))}})),g.length){var y=g.indexOf("height")>=0?window.pageYOffset:null,x=function(e,t,n){var r=t.measureViewportBox(),i=t.getInstance(),a=getComputedStyle(i),s=a.display,o={};"none"===s&&t.setStaticValue("display",e.display||"block"),n.forEach((function(e){o[e]=h[e](r,a)})),t.syncRender();var u=t.measureViewportBox();return n.forEach((function(n){var r=t.getValue(n);f(r,o[n]),e[n]=h[n](u,a)})),e}(i,e,g);return d.length&&d.forEach((function(n){var r=t.__read(n,2),i=r[0],a=r[1];e.getValue(i).set(a)})),e.syncRender(),null!==y&&window.scrollTo({top:y}),{target:x,transitionEnd:u}}return{target:i,transitionEnd:u}};exports.positionalValues=h,exports.unitConversion=function(e,t,n,r){return function(e){return Object.keys(e).some(l)}(t)?g(e,t,n,r):{target:t,transitionEnd:r}};
//# sourceMappingURL=unit-conversion.mjs.js.map
