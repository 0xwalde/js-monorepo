{"version":3,"file":"use-tap-gesture.mjs.js","sources":["../../../../../../../node_modules/framer-motion/dist/es/gestures/use-tap-gesture.mjs"],"sourcesContent":["import { useRef } from 'react';\nimport { isNodeOrChild } from './utils/is-node-or-child.mjs';\nimport { usePointerEvent, addPointerEvent } from '../events/use-pointer-event.mjs';\nimport { useUnmountEffect } from '../utils/use-unmount-effect.mjs';\nimport { pipe } from 'popmotion';\nimport { AnimationType } from '../render/utils/types.mjs';\nimport { isDragActive } from './drag/utils/lock.mjs';\n\n/**\n * @param handlers -\n * @internal\n */\nfunction useTapGesture(_a) {\n    var onTap = _a.onTap, onTapStart = _a.onTapStart, onTapCancel = _a.onTapCancel, whileTap = _a.whileTap, visualElement = _a.visualElement;\n    var hasPressListeners = onTap || onTapStart || onTapCancel || whileTap;\n    var isPressing = useRef(false);\n    var cancelPointerEndListeners = useRef(null);\n    /**\n     * Only set listener to passive if there are no external listeners.\n     */\n    var eventOptions = {\n        passive: !(onTapStart || onTap || onTapCancel || onPointerDown),\n    };\n    function removePointerEndListener() {\n        var _a;\n        (_a = cancelPointerEndListeners.current) === null || _a === void 0 ? void 0 : _a.call(cancelPointerEndListeners);\n        cancelPointerEndListeners.current = null;\n    }\n    function checkPointerEnd() {\n        var _a;\n        removePointerEndListener();\n        isPressing.current = false;\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Tap, false);\n        return !isDragActive();\n    }\n    function onPointerUp(event, info) {\n        if (!checkPointerEnd())\n            return;\n        /**\n         * We only count this as a tap gesture if the event.target is the same\n         * as, or a child of, this component's element\n         */\n        !isNodeOrChild(visualElement.getInstance(), event.target)\n            ? onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info)\n            : onTap === null || onTap === void 0 ? void 0 : onTap(event, info);\n    }\n    function onPointerCancel(event, info) {\n        if (!checkPointerEnd())\n            return;\n        onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info);\n    }\n    function onPointerDown(event, info) {\n        var _a;\n        removePointerEndListener();\n        if (isPressing.current)\n            return;\n        isPressing.current = true;\n        cancelPointerEndListeners.current = pipe(addPointerEvent(window, \"pointerup\", onPointerUp, eventOptions), addPointerEvent(window, \"pointercancel\", onPointerCancel, eventOptions));\n        /**\n         * Ensure we trigger animations before firing event callback\n         */\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(AnimationType.Tap, true);\n        onTapStart === null || onTapStart === void 0 ? void 0 : onTapStart(event, info);\n    }\n    usePointerEvent(visualElement, \"pointerdown\", hasPressListeners ? onPointerDown : undefined, eventOptions);\n    useUnmountEffect(removePointerEndListener);\n}\n\nexport { useTapGesture };\n"],"names":["_a","onTap","onTapStart","onTapCancel","whileTap","visualElement","hasPressListeners","isPressing","useRef","cancelPointerEndListeners","eventOptions","passive","onPointerDown","removePointerEndListener","current","call","checkPointerEnd","animationState","setActive","AnimationType","Tap","isDragActive","onPointerUp","event","info","isNodeOrChild","getInstance","target","onPointerCancel","pipe","addPointerEvent","window","usePointerEvent","undefined","useUnmountEffect"],"mappings":"4cAYA,SAAuBA,GACnB,IAAIC,EAAQD,EAAGC,MAAOC,EAAaF,EAAGE,WAAYC,EAAcH,EAAGG,YAAaC,EAAWJ,EAAGI,SAAUC,EAAgBL,EAAGK,cACvHC,EAAoBL,GAASC,GAAcC,GAAeC,EAC1DG,EAAaC,wBAAO,GACpBC,EAA4BD,uBAAO,MAInCE,EAAe,CACfC,UAAWT,GAAcD,GAASE,GAAeS,IAErD,SAASC,IACL,IAAIb,EACyC,QAA5CA,EAAKS,EAA0BK,eAA4B,IAAPd,GAAyBA,EAAGe,KAAKN,GACtFA,EAA0BK,QAAU,IACvC,CACD,SAASE,IACL,IAAIhB,EAIJ,OAHAa,IACAN,EAAWO,SAAU,EACmB,QAAvCd,EAAKK,EAAcY,sBAAmC,IAAPjB,GAAyBA,EAAGkB,UAAUC,EAAaA,cAACC,KAAK,IACjGC,EAAYA,cACvB,CACD,SAASC,EAAYC,EAAOC,GACnBR,MAMJS,EAAaA,cAACpB,EAAcqB,cAAeH,EAAMI,QAE5C1B,SAA8CA,EAAMsB,EAAOC,GAD3DrB,SAA0DA,EAAYoB,EAAOC,GAEtF,CACD,SAASI,EAAgBL,EAAOC,GACvBR,MAELb,SAA0DA,EAAYoB,EAAOC,GAChF,CACD,SAASZ,EAAcW,EAAOC,GAC1B,IAAIxB,EACJa,IACIN,EAAWO,UAEfP,EAAWO,SAAU,EACrBL,EAA0BK,QAAUe,EAAIA,KAACC,EAAeA,gBAACC,OAAQ,YAAaT,EAAaZ,GAAeoB,EAAAA,gBAAgBC,OAAQ,gBAAiBH,EAAiBlB,IAI5H,QAAvCV,EAAKK,EAAcY,sBAAmC,IAAPjB,GAAyBA,EAAGkB,UAAUC,EAAaA,cAACC,KAAK,GACzGlB,SAAwDA,EAAWqB,EAAOC,GAC7E,CACDQ,EAAeA,gBAAC3B,EAAe,cAAeC,EAAoBM,OAAgBqB,EAAWvB,GAC7FwB,EAAgBA,iBAACrB,EACrB"}