{"version":3,"file":"PresenceChild.mjs.js","sources":["../../../../../../../../node_modules/framer-motion/dist/es/components/AnimatePresence/PresenceChild.mjs"],"sourcesContent":["import { __values } from 'tslib';\nimport * as React from 'react';\nimport { useMemo } from 'react';\nimport { PresenceContext } from '../../context/PresenceContext.mjs';\nimport { useConstant } from '../../utils/use-constant.mjs';\nimport { useId } from '../../utils/use-id.mjs';\n\nvar PresenceChild = function (_a) {\n    var children = _a.children, initial = _a.initial, isPresent = _a.isPresent, onExitComplete = _a.onExitComplete, custom = _a.custom, presenceAffectsLayout = _a.presenceAffectsLayout;\n    var presenceChildren = useConstant(newChildrenMap);\n    var id = useId();\n    var context = useMemo(function () { return ({\n        id: id,\n        initial: initial,\n        isPresent: isPresent,\n        custom: custom,\n        onExitComplete: function (childId) {\n            var e_1, _a;\n            presenceChildren.set(childId, true);\n            try {\n                for (var _b = __values(presenceChildren.values()), _c = _b.next(); !_c.done; _c = _b.next()) {\n                    var isComplete = _c.value;\n                    if (!isComplete)\n                        return; // can stop searching when any is incomplete\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            onExitComplete === null || onExitComplete === void 0 ? void 0 : onExitComplete();\n        },\n        register: function (childId) {\n            presenceChildren.set(childId, false);\n            return function () { return presenceChildren.delete(childId); };\n        },\n    }); }, \n    /**\n     * If the presence of a child affects the layout of the components around it,\n     * we want to make a new context value to ensure they get re-rendered\n     * so they can detect that layout change.\n     */\n    presenceAffectsLayout ? undefined : [isPresent]);\n    useMemo(function () {\n        presenceChildren.forEach(function (_, key) { return presenceChildren.set(key, false); });\n    }, [isPresent]);\n    /**\n     * If there's no `motion` components to fire exit animations, we want to remove this\n     * component immediately.\n     */\n    React.useEffect(function () {\n        !isPresent && !presenceChildren.size && (onExitComplete === null || onExitComplete === void 0 ? void 0 : onExitComplete());\n    }, [isPresent]);\n    return (React.createElement(PresenceContext.Provider, { value: context }, children));\n};\nfunction newChildrenMap() {\n    return new Map();\n}\n\nexport { PresenceChild };\n"],"names":["newChildrenMap","Map","_a","children","initial","isPresent","onExitComplete","custom","presenceAffectsLayout","presenceChildren","useConstant","id","useId","context","useMemo","childId","e_1","set","_b","__values","values","_c","next","done","value","e_1_1","error","return","call","register","delete","undefined","forEach","_","key","React.useEffect","size","React.createElement","PresenceContext","Provider"],"mappings":"2VA0DA,SAASA,IACL,OAAO,IAAIC,GACf,uBArDoB,SAAUC,GAC1B,IAAIC,EAAWD,EAAGC,SAAUC,EAAUF,EAAGE,QAASC,EAAYH,EAAGG,UAAWC,EAAiBJ,EAAGI,eAAgBC,EAASL,EAAGK,OAAQC,EAAwBN,EAAGM,sBAC3JC,EAAmBC,cAAYV,GAC/BW,EAAKC,EAAAA,QACLC,EAAUC,yBAAQ,WAAc,MAAQ,CACxCH,GAAIA,EACJP,QAASA,EACTC,UAAWA,EACXE,OAAQA,EACRD,eAAgB,SAAUS,GACtB,IAAIC,EAAKd,EACTO,EAAiBQ,IAAIF,GAAS,GAC9B,IACI,IAAK,IAAIG,EAAKC,EAAQA,SAACV,EAAiBW,UAAWC,EAAKH,EAAGI,QAASD,EAAGE,KAAMF,EAAKH,EAAGI,OAAQ,CAEzF,IADiBD,EAAGG,MAEhB,MACP,CAQJ,CAND,MAAOC,GAAST,EAAM,CAAEU,MAAOD,EAAU,CACjC,QACJ,IACQJ,IAAOA,EAAGE,OAASrB,EAAKgB,EAAGS,SAASzB,EAAG0B,KAAKV,EAEf,CAA7B,QAAE,GAAIF,EAAK,MAAMA,EAAIU,KAAQ,CACxC,CACDpB,SAAgEA,GACnE,EACDuB,SAAU,SAAUd,GAEhB,OADAN,EAAiBQ,IAAIF,GAAS,GACvB,WAAc,OAAON,EAAiBqB,OAAOf,EAAS,CAChE,EACA,GAMLP,OAAwBuB,EAAY,CAAC1B,IAWrC,OAVAS,EAAAA,MAAAA,QAAAA,SAAQ,WACJL,EAAiBuB,SAAQ,SAAUC,EAAGC,GAAO,OAAOzB,EAAiBQ,IAAIiB,GAAK,EAAS,GAC/F,GAAO,CAAC7B,IAKJ8B,EAAAA,MAAAA,QAAAA,WAAgB,YACX9B,IAAcI,EAAiB2B,OAAS9B,SAAgEA,IACjH,GAAO,CAACD,IACIgC,EAAAA,MAAAA,QAAAA,cAAoBC,EAAAA,gBAAgBC,SAAU,CAAEf,MAAOX,GAAWV,EAC9E"}