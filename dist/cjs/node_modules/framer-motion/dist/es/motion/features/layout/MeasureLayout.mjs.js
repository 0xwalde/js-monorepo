"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../../../../../tslib/tslib.es6.js"),o=require("../../../../../node_modules/framesync/dist/es/index.mjs.js"),t=require("../../../../../../react/index.js"),r=require("../../../components/AnimatePresence/use-presence.mjs.js"),s=require("../../../context/LayoutGroupContext.mjs.js"),i=require("../../../context/SwitchLayoutGroupContext.mjs.js"),n=require("../../../projection/node/state.mjs.js"),u=require("../../../projection/styles/scale-border-radius.mjs.js"),a=require("../../../projection/styles/scale-box-shadow.mjs.js"),d=require("../../../projection/styles/scale-correction.mjs.js"),p=require("../../../../../../../_virtual/index.js"),c=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(r,t),r.prototype.componentDidMount=function(){var o=this,t=this.props,r=t.visualElement,s=t.layoutGroup,i=t.switchLayoutGroup,u=t.layoutId,a=r.projection;d.addScaleCorrector(l),a&&((null==s?void 0:s.group)&&s.group.add(a),(null==i?void 0:i.register)&&u&&i.register(a),a.root.didUpdate(),a.addEventListener("animationComplete",(function(){o.safeToRemove()})),a.setOptions(e.__assign(e.__assign({},a.options),{onExitComplete:function(){return o.safeToRemove()}}))),n.globalProjectionState.hasEverUpdated=!0},r.prototype.getSnapshotBeforeUpdate=function(e){var t=this,r=this.props,s=r.layoutDependency,i=r.visualElement,n=r.drag,u=r.isPresent,a=i.projection;return a?(a.isPresent=u,n||e.layoutDependency!==s||void 0===s?a.willUpdate():this.safeToRemove(),e.isPresent!==u&&(u?a.promote():a.relegate()||o.default.postRender((function(){var e;(null===(e=a.getStack())||void 0===e?void 0:e.members.length)||t.safeToRemove()}))),null):null},r.prototype.componentDidUpdate=function(){var e=this.props.visualElement.projection;e&&(e.root.didUpdate(),!e.currentAnimation&&e.isLead()&&this.safeToRemove())},r.prototype.componentWillUnmount=function(){var e=this.props,o=e.visualElement,t=e.layoutGroup,r=e.switchLayoutGroup,s=o.projection;s&&(s.scheduleCheckAfterUnmount(),(null==t?void 0:t.group)&&t.group.remove(s),(null==r?void 0:r.deregister)&&r.deregister(s))},r.prototype.safeToRemove=function(){var e=this.props.safeToRemove;null==e||e()},r.prototype.render=function(){return null},r}(t.Component);var l={borderRadius:e.__assign(e.__assign({},u.correctBorderRadius),{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:u.correctBorderRadius,borderTopRightRadius:u.correctBorderRadius,borderBottomLeftRadius:u.correctBorderRadius,borderBottomRightRadius:u.correctBorderRadius,boxShadow:a.correctBoxShadow};exports.MeasureLayout=function(o){var n=e.__read(r.usePresence(),2),u=n[0],a=n[1],d=p.react.exports.useContext(s.LayoutGroupContext);return t.createElement(c,e.__assign({},o,{layoutGroup:d,switchLayoutGroup:p.react.exports.useContext(i.SwitchLayoutGroupContext),isPresent:u,safeToRemove:a}))};
//# sourceMappingURL=MeasureLayout.mjs.js.map
