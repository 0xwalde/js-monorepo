{"version":3,"file":"flip.js","sources":["../../../../../../../node_modules/@popperjs/core/lib/modifiers/flip.js"],"sourcesContent":["import getOppositePlacement from \"../utils/getOppositePlacement.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getOppositeVariationPlacement from \"../utils/getOppositeVariationPlacement.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\nimport computeAutoPlacement from \"../utils/computeAutoPlacement.js\";\nimport { bottom, top, start, right, left, auto } from \"../enums.js\";\nimport getVariation from \"../utils/getVariation.js\"; // eslint-disable-next-line import/no-unused-modules\n\nfunction getExpandedFallbackPlacements(placement) {\n  if (getBasePlacement(placement) === auto) {\n    return [];\n  }\n\n  var oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];\n}\n\nfunction flip(_ref) {\n  var state = _ref.state,\n      options = _ref.options,\n      name = _ref.name;\n\n  if (state.modifiersData[name]._skip) {\n    return;\n  }\n\n  var _options$mainAxis = options.mainAxis,\n      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,\n      _options$altAxis = options.altAxis,\n      checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis,\n      specifiedFallbackPlacements = options.fallbackPlacements,\n      padding = options.padding,\n      boundary = options.boundary,\n      rootBoundary = options.rootBoundary,\n      altBoundary = options.altBoundary,\n      _options$flipVariatio = options.flipVariations,\n      flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio,\n      allowedAutoPlacements = options.allowedAutoPlacements;\n  var preferredPlacement = state.options.placement;\n  var basePlacement = getBasePlacement(preferredPlacement);\n  var isBasePlacement = basePlacement === preferredPlacement;\n  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));\n  var placements = [preferredPlacement].concat(fallbackPlacements).reduce(function (acc, placement) {\n    return acc.concat(getBasePlacement(placement) === auto ? computeAutoPlacement(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding,\n      flipVariations: flipVariations,\n      allowedAutoPlacements: allowedAutoPlacements\n    }) : placement);\n  }, []);\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var checksMap = new Map();\n  var makeFallbackChecks = true;\n  var firstFittingPlacement = placements[0];\n\n  for (var i = 0; i < placements.length; i++) {\n    var placement = placements[i];\n\n    var _basePlacement = getBasePlacement(placement);\n\n    var isStartVariation = getVariation(placement) === start;\n    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;\n    var len = isVertical ? 'width' : 'height';\n    var overflow = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      altBoundary: altBoundary,\n      padding: padding\n    });\n    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;\n\n    if (referenceRect[len] > popperRect[len]) {\n      mainVariationSide = getOppositePlacement(mainVariationSide);\n    }\n\n    var altVariationSide = getOppositePlacement(mainVariationSide);\n    var checks = [];\n\n    if (checkMainAxis) {\n      checks.push(overflow[_basePlacement] <= 0);\n    }\n\n    if (checkAltAxis) {\n      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);\n    }\n\n    if (checks.every(function (check) {\n      return check;\n    })) {\n      firstFittingPlacement = placement;\n      makeFallbackChecks = false;\n      break;\n    }\n\n    checksMap.set(placement, checks);\n  }\n\n  if (makeFallbackChecks) {\n    // `2` may be desired in some cases â€“ research later\n    var numberOfChecks = flipVariations ? 3 : 1;\n\n    var _loop = function _loop(_i) {\n      var fittingPlacement = placements.find(function (placement) {\n        var checks = checksMap.get(placement);\n\n        if (checks) {\n          return checks.slice(0, _i).every(function (check) {\n            return check;\n          });\n        }\n      });\n\n      if (fittingPlacement) {\n        firstFittingPlacement = fittingPlacement;\n        return \"break\";\n      }\n    };\n\n    for (var _i = numberOfChecks; _i > 0; _i--) {\n      var _ret = _loop(_i);\n\n      if (_ret === \"break\") break;\n    }\n  }\n\n  if (state.placement !== firstFittingPlacement) {\n    state.modifiersData[name]._skip = true;\n    state.placement = firstFittingPlacement;\n    state.reset = true;\n  }\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'flip',\n  enabled: true,\n  phase: 'main',\n  fn: flip,\n  requiresIfExists: ['offset'],\n  data: {\n    _skip: false\n  }\n};"],"names":["flip$1","name","enabled","phase","fn","_ref","state","options","modifiersData","_skip","_options$mainAxis","mainAxis","checkMainAxis","_options$altAxis","altAxis","checkAltAxis","specifiedFallbackPlacements","fallbackPlacements","padding","boundary","rootBoundary","altBoundary","_options$flipVariatio","flipVariations","allowedAutoPlacements","preferredPlacement","placement","basePlacement","getBasePlacement","getOppositePlacement","auto","oppositePlacement","getOppositeVariationPlacement","getExpandedFallbackPlacements","placements","concat","reduce","acc","computeAutoPlacement","referenceRect","rects","reference","popperRect","popper","checksMap","Map","makeFallbackChecks","firstFittingPlacement","i","length","_basePlacement","isStartVariation","getVariation","start","isVertical","top","bottom","indexOf","len","overflow","detectOverflow","mainVariationSide","right","left","altVariationSide","checks","push","every","check","set","_loop","_i","fittingPlacement","find","get","slice","reset","requiresIfExists","data"],"mappings":"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"}