"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../../tslib/tslib.es6.js");require("../../../react/index.js");var t=require("../../../react-remove-scroll-bar/dist/es2015/component.js"),r=require("../../../react-style-singleton/dist/es2015/component.js"),n=require("./aggresiveCapture.js"),c=require("./handleScroll.js"),a=require("../../../../_virtual/index.js"),o=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},u=function(e){return[e.deltaX,e.deltaY]},s=function(e){return e&&"current"in e?e.current:e},i=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},l=0,f=[];exports.RemoveScrollSideCar=function(v){var d=a.react.exports.useRef([]),p=a.react.exports.useRef([0,0]),h=a.react.exports.useRef(),m=a.react.exports.useState(l++)[0],g=a.react.exports.useState((function(){return r.styleSingleton()}))[0],x=a.react.exports.useRef(v);a.react.exports.useEffect((function(){x.current=v}),[v]),a.react.exports.useEffect((function(){if(v.inert){document.body.classList.add("block-interactivity-".concat(m));var t=e.__spreadArray([v.lockRef.current],(v.shards||[]).map(s),!0).filter(Boolean);return t.forEach((function(e){return e.classList.add("allow-interactivity-".concat(m))})),function(){document.body.classList.remove("block-interactivity-".concat(m)),t.forEach((function(e){return e.classList.remove("allow-interactivity-".concat(m))}))}}}),[v.inert,v.lockRef.current,v.shards]);var b=a.react.exports.useCallback((function(e,t){if("touches"in e&&2===e.touches.length)return!x.current.allowPinchZoom;var r,n=o(e),a=p.current,u="deltaX"in e?e.deltaX:a[0]-n[0],s="deltaY"in e?e.deltaY:a[1]-n[1],i=e.target,l=Math.abs(u)>Math.abs(s)?"h":"v";if("touches"in e&&"h"===l&&"range"===i.type)return!1;var f=c.locationCouldBeScrolled(l,i);if(!f)return!0;if(f?r=l:(r="v"===l?"h":"v",f=c.locationCouldBeScrolled(l,i)),!f)return!1;if(!h.current&&"changedTouches"in e&&(u||s)&&(h.current=r),!r)return!0;var v=h.current||r;return c.handleScroll(v,t,e,"h"===v?u:s,!0)}),[]),y=a.react.exports.useCallback((function(e){var t=e;if(f.length&&f[f.length-1]===g){var r="deltaY"in t?u(t):o(t),n=d.current.filter((function(e){return e.name===t.type&&e.target===t.target&&(n=e.delta,c=r,n[0]===c[0]&&n[1]===c[1]);var n,c}))[0];if(n&&n.should)t.cancelable&&t.preventDefault();else if(!n){var c=(x.current.shards||[]).map(s).filter(Boolean).filter((function(e){return e.contains(t.target)}));(c.length>0?b(t,c[0]):!x.current.noIsolation)&&t.cancelable&&t.preventDefault()}}}),[]),k=a.react.exports.useCallback((function(e,t,r,n){var c={name:e,delta:t,target:r,should:n};d.current.push(c),setTimeout((function(){d.current=d.current.filter((function(e){return e!==c}))}),1)}),[]),C=a.react.exports.useCallback((function(e){p.current=o(e),h.current=void 0}),[]),E=a.react.exports.useCallback((function(e){k(e.type,u(e),e.target,b(e,v.lockRef.current))}),[]),S=a.react.exports.useCallback((function(e){k(e.type,o(e),e.target,b(e,v.lockRef.current))}),[]);a.react.exports.useEffect((function(){return f.push(g),v.setCallbacks({onScrollCapture:E,onWheelCapture:E,onTouchMoveCapture:S}),document.addEventListener("wheel",y,n.nonPassive),document.addEventListener("touchmove",y,n.nonPassive),document.addEventListener("touchstart",C,n.nonPassive),function(){f=f.filter((function(e){return e!==g})),document.removeEventListener("wheel",y,n.nonPassive),document.removeEventListener("touchmove",y,n.nonPassive),document.removeEventListener("touchstart",C,n.nonPassive)}}),[]);var L=v.removeScrollBar,R=v.inert;return a.react.exports.createElement(a.react.exports.Fragment,null,R?a.react.exports.createElement(g,{styles:i(m)}):null,L?a.react.exports.createElement(t.RemoveScrollBar,{gapMode:"margin"}):null)},exports.getDeltaXY=u,exports.getTouchXY=o;
//# sourceMappingURL=SideEffect.js.map
