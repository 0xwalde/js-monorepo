{"version":3,"file":"find-spring.mjs.js","sources":["../../../../../../../../node_modules/popmotion/dist/es/animations/utils/find-spring.mjs"],"sourcesContent":["import { warning } from 'hey-listen';\nimport { clamp } from '../../utils/clamp.mjs';\n\nconst safeMin = 0.001;\nconst minDuration = 0.01;\nconst maxDuration = 10.0;\nconst minDamping = 0.05;\nconst maxDamping = 1;\nfunction findSpring({ duration = 800, bounce = 0.25, velocity = 0, mass = 1, }) {\n    let envelope;\n    let derivative;\n    warning(duration <= maxDuration * 1000, \"Spring duration must be 10 seconds or less\");\n    let dampingRatio = 1 - bounce;\n    dampingRatio = clamp(minDamping, maxDamping, dampingRatio);\n    duration = clamp(minDuration, maxDuration, duration / 1000);\n    if (dampingRatio < 1) {\n        envelope = (undampedFreq) => {\n            const exponentialDecay = undampedFreq * dampingRatio;\n            const delta = exponentialDecay * duration;\n            const a = exponentialDecay - velocity;\n            const b = calcAngularFreq(undampedFreq, dampingRatio);\n            const c = Math.exp(-delta);\n            return safeMin - (a / b) * c;\n        };\n        derivative = (undampedFreq) => {\n            const exponentialDecay = undampedFreq * dampingRatio;\n            const delta = exponentialDecay * duration;\n            const d = delta * velocity + velocity;\n            const e = Math.pow(dampingRatio, 2) * Math.pow(undampedFreq, 2) * duration;\n            const f = Math.exp(-delta);\n            const g = calcAngularFreq(Math.pow(undampedFreq, 2), dampingRatio);\n            const factor = -envelope(undampedFreq) + safeMin > 0 ? -1 : 1;\n            return (factor * ((d - e) * f)) / g;\n        };\n    }\n    else {\n        envelope = (undampedFreq) => {\n            const a = Math.exp(-undampedFreq * duration);\n            const b = (undampedFreq - velocity) * duration + 1;\n            return -safeMin + a * b;\n        };\n        derivative = (undampedFreq) => {\n            const a = Math.exp(-undampedFreq * duration);\n            const b = (velocity - undampedFreq) * (duration * duration);\n            return a * b;\n        };\n    }\n    const initialGuess = 5 / duration;\n    const undampedFreq = approximateRoot(envelope, derivative, initialGuess);\n    duration = duration * 1000;\n    if (isNaN(undampedFreq)) {\n        return {\n            stiffness: 100,\n            damping: 10,\n            duration,\n        };\n    }\n    else {\n        const stiffness = Math.pow(undampedFreq, 2) * mass;\n        return {\n            stiffness,\n            damping: dampingRatio * 2 * Math.sqrt(mass * stiffness),\n            duration,\n        };\n    }\n}\nconst rootIterations = 12;\nfunction approximateRoot(envelope, derivative, initialGuess) {\n    let result = initialGuess;\n    for (let i = 1; i < rootIterations; i++) {\n        result = result - envelope(result) / derivative(result);\n    }\n    return result;\n}\nfunction calcAngularFreq(undampedFreq, dampingRatio) {\n    return undampedFreq * Math.sqrt(1 - dampingRatio * dampingRatio);\n}\n\nexport { calcAngularFreq, findSpring, maxDamping, maxDuration, minDamping, minDuration };\n"],"names":["calcAngularFreq","undampedFreq","dampingRatio","Math","sqrt","duration","bounce","velocity","mass","envelope","derivative","warning","maxDuration","clamp","exponentialDecay","delta","exp","d","e","pow","f","g","initialGuess","result","i","approximateRoot","isNaN","stiffness","damping"],"mappings":"2KA0EA,SAASA,EAAgBC,EAAcC,GACnC,OAAOD,EAAeE,KAAKC,KAAK,EAAIF,EAAeA,EACvD,8CApEA,UAAoBG,SAAEA,EAAW,IAAGC,OAAEA,EAAS,IAAIC,SAAEA,EAAW,EAACC,KAAEA,EAAO,IACtE,IAAIC,EACAC,EACJC,EAAAA,QAAQN,GAAYO,IAAoB,8CACxC,IAAIV,EAAe,EAAII,EACvBJ,EAAeW,EAAAA,MAPA,IACA,EAM8BX,GAC7CG,EAAWQ,EAAKA,MAVA,IACA,GAS2BR,EAAW,KAClDH,EAAe,GACfO,EAAYR,IACR,MAAMa,EAAmBb,EAAeC,EAClCa,EAAQD,EAAmBT,EAIjC,MAnBI,MAgBMS,EAAmBP,GACnBP,EAAgBC,EAAcC,GAC9BC,KAAKa,KAAKD,EACQ,EAEhCL,EAAcT,IACV,MACMc,EADmBd,EAAeC,EACPG,EAC3BY,EAAIF,EAAQR,EAAWA,EACvBW,EAAIf,KAAKgB,IAAIjB,EAAc,GAAKC,KAAKgB,IAAIlB,EAAc,GAAKI,EAC5De,EAAIjB,KAAKa,KAAKD,GACdM,EAAIrB,EAAgBG,KAAKgB,IAAIlB,EAAc,GAAIC,GAErD,OA7BI,KA4BYO,EAASR,GAA0B,GAAK,EAAI,KACzCgB,EAAIC,GAAKE,GAAMC,CAAC,IAIvCZ,EAAYR,GACEE,KAAKa,KAAKf,EAAeI,KACxBJ,EAAeM,GAAYF,EAAW,GAnC7C,KAsCRK,EAAcT,GACAE,KAAKa,KAAKf,EAAeI,IACIA,EAAWA,GAAvCE,EAAWN,KAI9B,MACMA,EAmBV,SAAyBQ,EAAUC,EAAYY,GAC3C,IAAIC,EAASD,EACb,IAAK,IAAIE,EAAI,EAAGA,EAHG,GAGiBA,IAChCD,GAAkBd,EAASc,GAAUb,EAAWa,GAEpD,OAAOA,CACX,CAzByBE,CAAgBhB,EAAUC,EAD1B,EAAIL,GAGzB,GADAA,GAAsB,IAClBqB,MAAMzB,GACN,MAAO,CACH0B,UAAW,IACXC,QAAS,GACTvB,YAGH,CACD,MAAMsB,EAAYxB,KAAKgB,IAAIlB,EAAc,GAAKO,EAC9C,MAAO,CACHmB,YACAC,QAAwB,EAAf1B,EAAmBC,KAAKC,KAAKI,EAAOmB,GAC7CtB,WAEP,CACL,qBA1DmB,sBAFC,sBACD,wBAFC"}